## Репозиторий с домашними заданиями по курсу "Машинное обучение в продакшене" в Академии больших данных MADE Mail.ru Group

Owner: [viconstel](https://data.mail.ru/profile/k.elizarov/)

## Структура проекта

* Директория **homework1**. <br>
*Задание:* Вам потребуется сделать 
*production ready* проект для решения задачи 
классификации, то есть написать код 
для обучения и предикта, покрыть его тестами, 
обучить с помощью него модельку.<br>

Пункты задания:
1. Выполните EDA, закоммитьте ноутбук в папку с ноутбуками.
2. Сделайте модульную структуру проекта.
3. Используйте логгеры.
4. Напишите тесты на отдельные модули и на прогон всего пайплайна.
5. Для тестов генерируются синтетические данные, приближенные к реальным.
6. Обучение модели конфигурируется с помощью конфигов в `json` или `yaml`.
7. Используются датаклассы для сущностей из конфига, а не голые `dict`.
8. Используйте кастомный трансформер(написанный своими руками) и протестируйте его.
9. Обучите модель, запишите в readme как это предлагается.
10. Напишите функцию `predict`, которая примет на вход артефакт/ы от обучения, тестовую выборку(без меток) и запишет предикт, напишите в readme как это сделать.


[README](https://github.com/viconstel/ml-in-production/blob/cb3dcf0945627efdfc8d575c08ef1afa2dc38a21/homework1/README.md) файл сделанного проекта.

* Директория **online_inference**. <br>
*Задание:* В прошлом ДЗ вы обучили модель 
для решения задачи классификации, новое задание,
 это обернуть ее в вид, пригодный 
 для использования в режиме онлайн. <br>
 
 Пункты задания:
 1. Оберните inference вашей модели в `REST` сервис, должен быть endpoint `/predict`.
 2. Напишите тест для `/predict`.
 3. Напишите скрипт, который будет делать запросы к вашему сервису.
 4. Сделайте валидацию входных данных.
 5. Напишите `Dockerfile`, соберите на его основе образ и запустите локально контейнер(`docker build, docker run`), внутри контейнера должен запускать сервис, написанный в предущем пункте, закоммитьте его, напишите в readme корректную команду сборки.
 6. Оптимизируйте размер docker image.
 7. опубликуйте образ в https://hub.docker.com/, используя `docker push`.
 8. напишите в readme корректные команды `docker pull/run`, которые должны привести к тому, что локально поднимется на inference ваша модель.
 
 [README](https://github.com/viconstel/ml-in-production/blob/cb3dcf0945627efdfc8d575c08ef1afa2dc38a21/online_inference/README.md) файл сделанного проекта.
 
* Директория **airflow_ml_dags**. <br>
*Задание:* В ДЗ предлагается познакомиться с 
`Airflow`. <br>
 
Пункты задания:
1. Поднимите `Airflow` локально, используя `docker compose`.
2. Реализуйте *dag*, который генерирует данные для обучения модели, вам важно проэмулировать ситуации постоянно поступающих данных.
3. Реализуйте *dag*, который обучает модель еженедельно, используя данные за текущий день.
4. Реализуйте *dag*, который использует модель ежедневно.
5. Реализуйте сенсоры на то, что данные готовы для дагов тренировки и обучения.
6. Все даги реализованы только с помощью `DockerOperator`.
7. Протестируйте ваши даги.
8. Настройте *alert* в случае падения дага.
 
[README](https://github.com/viconstel/ml-in-production/blob/cb3dcf0945627efdfc8d575c08ef1afa2dc38a21/airflow_ml_dags/README.md) файл сделанного проекта.

* Директория **kubernetes**. <br>
*Задание:* Представляю вам последнее ДЗ, 
оно направлено на знакомство с `Kubernetes`. 
Задание, как и обещал, является логическим 
продолжением второго. В каждом пункте вам 
потребуется поднятый `Kubernetes` кластер 
и утилита, которая помогает 
с ним взаимодействовать. <br>

Пункты задания:
1. Установите `kubectl`.
2. Разверните `Kubernetes`.
3. Напишите простой *pod manifests* для вашего приложения.
Задеплойте приложение в кластер (`kubectl apply -f online-inference-pod.yaml`), убедитесь, что все поднялось (`kubectl get pods`).
4. Пропишите *requests/limits*.
5. Модифицируйте свое приложение так, чтобы оно стартовало не сразу(с задержкой секунд 20-30) и падало спустя минуты работы. 
Добавьте `liveness` и `readiness` пробы, посмотрите что будет происходить.
6. Создайте `replicaset`, сделайте 3 реплики вашего приложения.
7. Опишите деплоймент для вашего приложения. Играя с параметрами деплоя(`maxSurge`, `maxUnavaliable`), добейтесь ситуации, когда при деплое новой версии:
+ Есть момент времени, когда на кластере есть как все старые поды, так и все новые (опишите эту ситуацию);
+ Одновременно с поднятием новых версии, гасятся старые.

[README](https://github.com/viconstel/ml-in-production/blob/cb3dcf0945627efdfc8d575c08ef1afa2dc38a21/kubernetes/README.md) файл сделанного проекта.

 
 